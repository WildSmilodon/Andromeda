!
!     Gauss integration library
!     (c) Jure Ravnik, 2017
!
      MODULE GaussIntegration
      
      USE mCommon
      IMPLICIT NONE
      
!
! -----------------------------------------------------------------------------------------
!
!
!
! -----------------------------------------------------------------------------------------
!
      TYPE GaussType
         INTEGER :: n    ! gre od 1 do 8=48)
         REAL(rk), POINTER :: gi(:),ome(:)
         INTEGER, POINTER :: ng1(:),ng2(:)
      END TYPE
!
!     Variables
!
      TYPE(GaussType) :: gaus
!
!     Subroutines
!
      CONTAINS


!______________________________________________________________________________
      SUBROUTINE GaussPosWeights()
!
!     Defines positions and weights for gauss quadrature
!     Bronstein 730, 441
!
      ALLOCATE(gaus%gi(156),gaus%ome(156))
      ALLOCATE(gaus%ng1(8),gaus%ng2(8))

!---  N =   2  ( ng1 =  1 , ng2 =  2 )
      gaus%ng1(1)=1
      gaus%ng2(1)=2
      gaus%gi(1)   = -0.5773502691896258_rk
      gaus%gi(2)   =  0.5773502691896258_rk
      gaus%ome(1)  =  1.0000000000000000_rk
      gaus%ome(2)  =  1.0000000000000000_rk

!---  N =   4 ( ng1 =  3 , ng2 =  6 )
      gaus%ng1(2)=3
      gaus%ng2(2)=6
      gaus%gi(3)   = -0.8611363115940526_rk
      gaus%gi(4)   = -0.3399810435848563_rk
      gaus%gi(5)   =  0.3399810435848563_rk
      gaus%gi(6)   =  0.8611363115940526_rk
      gaus%ome(3)  =  0.3478548451374539_rk
      gaus%ome(4)  =  0.6521451548625462_rk
      gaus%ome(5)  =  0.6521451548625462_rk
      gaus%ome(6)  =  0.3478548451374539_rk

!---  N =   6 ( ng1 =  7 , ng2 = 12 )
      gaus%ng1(3)=7
      gaus%ng2(3)=12
      gaus%gi(7)   = -0.9324695142031520_rk
      gaus%gi(8)   = -0.6612093864662645_rk
      gaus%gi(9)   = -0.2386191860831969_rk
      gaus%gi(10)  =  0.2386191860831971_rk
      gaus%gi(11)  =  0.6612093864662646_rk
      gaus%gi(12)  =  0.9324695142031521_rk
      gaus%ome(7)  =  0.1713244923791704_rk
      gaus%ome(8)  =  0.3607615730481386_rk
      gaus%ome(9)  =  0.4679139345726910_rk
      gaus%ome(10) =  0.4679139345726910_rk
      gaus%ome(11) =  0.3607615730481386_rk
      gaus%ome(12) =  0.1713244923791703_rk

!---  N =   8 ( ng1 =  13 , ng2 = 20 )
      gaus%ng1(4)=13
      gaus%ng2(4)=20
      gaus%gi(13)  = -0.9602898564975362_rk
      gaus%gi(14)  = -0.7966664774136267_rk
      gaus%gi(15)  = -0.5255324099163290_rk
      gaus%gi(16)  = -0.1834346424956499_rk
      gaus%gi(17)  =  0.1834346424956499_rk
      gaus%gi(18)  =  0.5255324099163290_rk
      gaus%gi(19)  =  0.7966664774136267_rk
      gaus%gi(20)  =  0.9602898564975362_rk
      gaus%ome(13) =  0.1012285362903762_rk
      gaus%ome(14) =  0.2223810344533745_rk
      gaus%ome(15) =  0.3137066458778873_rk
      gaus%ome(16) =  0.3626837833783620_rk
      gaus%ome(17) =  0.3626837833783620_rk
      gaus%ome(18) =  0.3137066458778873_rk
      gaus%ome(19) =  0.2223810344533745_rk
      gaus%ome(20) =  0.1012285362903764_rk

!---  N =  16 ( ng1 =  21 , ng2 = 36 )
      gaus%ng1(5)=21
      gaus%ng2(5)=36
      gaus%gi(21) = -0.9894009349916499_rk
      gaus%gi(22) = -0.9445750230732326_rk
      gaus%gi(23) = -0.8656312023878318_rk
      gaus%gi(24) = -0.7554044083550030_rk
      gaus%gi(25) = -0.6178762444026437_rk
      gaus%gi(26) = -0.4580167776572274_rk
      gaus%gi(27) = -0.2816035507792589_rk
      gaus%gi(28) = -0.0950125098376375_rk
      gaus%gi(29) =  0.0950125098376374_rk
      gaus%gi(30) =  0.2816035507792590_rk
      gaus%gi(31) =  0.4580167776572274_rk
      gaus%gi(32) =  0.6178762444026437_rk
      gaus%gi(33) =  0.7554044083550031_rk
      gaus%gi(34) =  0.8656312023878318_rk
      gaus%gi(35) =  0.9445750230732326_rk
      gaus%gi(36) =  0.9894009349916500_rk
      gaus%ome(21)=  0.0271524594117541_rk
      gaus%ome(22)=  0.0622535239386479_rk
      gaus%ome(23)=  0.0951585116824928_rk
      gaus%ome(24)=  0.1246289712555339_rk
      gaus%ome(25)=  0.1495959888165767_rk
      gaus%ome(26)=  0.1691565193950025_rk
      gaus%ome(27)=  0.1826034150449236_rk
      gaus%ome(28)=  0.1894506104550685_rk
      gaus%ome(29)=  0.1894506104550685_rk
      gaus%ome(30)=  0.1826034150449236_rk
      gaus%ome(31)=  0.1691565193950025_rk
      gaus%ome(32)=  0.1495959888165767_rk
      gaus%ome(33)=  0.1246289712555338_rk
      gaus%ome(34)=  0.0951585116824927_rk
      gaus%ome(35)=  0.0622535239386479_rk
      gaus%ome(36)=  0.0271524594117539_rk

!---  N =  32( ng1 =  37 , ng2 = 68 )
      gaus%ng1(6)=37
      gaus%ng2(6)=68
      gaus%gi(37) = -0.9972638618494815_rk
      gaus%gi(38) = -0.9856115115452683_rk
      gaus%gi(39) = -0.9647622555875064_rk
      gaus%gi(40) = -0.9349060759377397_rk
      gaus%gi(41) = -0.8963211557660521_rk
      gaus%gi(42) = -0.8493676137325700_rk
      gaus%gi(43) = -0.7944837959679424_rk
      gaus%gi(44) = -0.7321821187402897_rk
      gaus%gi(45) = -0.6630442669302152_rk
      gaus%gi(46) = -0.5877157572407623_rk
      gaus%gi(47) = -0.5068999089322294_rk
      gaus%gi(48) = -0.4213512761306354_rk
      gaus%gi(49) = -0.3318686022821277_rk
      gaus%gi(50) = -0.2392873622521372_rk
      gaus%gi(51) = -0.1444719615827965_rk
      gaus%gi(52) = -0.0483076656877383_rk
      gaus%gi(53) =  0.0483076656877384_rk
      gaus%gi(54) =  0.1444719615827965_rk
      gaus%gi(55) =  0.2392873622521372_rk
      gaus%gi(56) =  0.3318686022821278_rk
      gaus%gi(57) =  0.4213512761306355_rk
      gaus%gi(58) =  0.5068999089322294_rk
      gaus%gi(59) =  0.5877157572407624_rk
      gaus%gi(60) =  0.6630442669302153_rk
      gaus%gi(61) =  0.7321821187402897_rk
      gaus%gi(62) =  0.7944837959679424_rk
      gaus%gi(63) =  0.8493676137325699_rk
      gaus%gi(64) =  0.8963211557660521_rk
      gaus%gi(65) =  0.9349060759377397_rk
      gaus%gi(66) =  0.9647622555875065_rk
      gaus%gi(67) =  0.9856115115452684_rk
      gaus%gi(68) =  0.9972638618494816_rk
      gaus%ome(37)=  0.0070186100094701_rk
      gaus%ome(38)=  0.0162743947309057_rk
      gaus%ome(39)=  0.0253920653092621_rk
      gaus%ome(40)=  0.0342738629130214_rk
      gaus%ome(41)=  0.0428358980222267_rk
      gaus%ome(42)=  0.0509980592623762_rk
      gaus%ome(43)=  0.0586840934785356_rk
      gaus%ome(44)=  0.0658222227763618_rk
      gaus%ome(45)=  0.0723457941088485_rk
      gaus%ome(46)=  0.0781938957870703_rk
      gaus%ome(47)=  0.0833119242269468_rk
      gaus%ome(48)=  0.0876520930044038_rk
      gaus%ome(49)=  0.0911738786957639_rk
      gaus%ome(50)=  0.0938443990808046_rk
      gaus%ome(51)=  0.0956387200792749_rk
      gaus%ome(52)=  0.0965400885147278_rk
      gaus%ome(53)=  0.0965400885147278_rk
      gaus%ome(54)=  0.0956387200792749_rk
      gaus%ome(55)=  0.0938443990808046_rk
      gaus%ome(56)=  0.0911738786957639_rk
      gaus%ome(57)=  0.0876520930044038_rk
      gaus%ome(58)=  0.0833119242269468_rk
      gaus%ome(59)=  0.0781938957870703_rk
      gaus%ome(60)=  0.0723457941088485_rk
      gaus%ome(61)=  0.0658222227763619_rk
      gaus%ome(62)=  0.0586840934785355_rk
      gaus%ome(63)=  0.0509980592623762_rk
      gaus%ome(64)=  0.0428358980222267_rk
      gaus%ome(65)=  0.0342738629130214_rk
      gaus%ome(66)=  0.0253920653092620_rk
      gaus%ome(67)=  0.0162743947309056_rk
      gaus%ome(68)=  0.0070186100094699_rk

!---  N =  40 ( ng1 =  69 , ng2 = 108 )
      gaus%ng1(7)=69
      gaus%ng2(7)=108
      gaus%gi(69)= -0.998237709710559200350_rk
      gaus%gi(70)= -0.990726238699457006453_rk
      gaus%gi(71)= -0.977259949983774262663_rk
      gaus%gi(72)= -0.957916819213791655805_rk
      gaus%gi(73)= -0.932812808278676533361_rk
      gaus%gi(74)= -0.902098806968874296728_rk
      gaus%gi(75)= -0.865959503212259503821_rk
      gaus%gi(76)= -0.824612230833311663196_rk
      gaus%gi(77)= -0.778305651426519387695_rk
      gaus%gi(78)= -0.727318255189927103281_rk
      gaus%gi(79)= -0.671956684614179548379_rk
      gaus%gi(80)= -0.612553889667980237953_rk
      gaus%gi(81)= -0.549467125095128202076_rk
      gaus%gi(82)= -0.483075801686178712909_rk
      gaus%gi(83)= -0.413779204371605001525_rk
      gaus%gi(84)= -0.341994090825758473007_rk
      gaus%gi(85)= -0.268152185007253681141_rk
      gaus%gi(86)= -0.192697580701371099716_rk
      gaus%gi(87)= -0.116084070675255208483_rk
      gaus%gi(88)= -0.038772417506050821933_rk

      gaus%gi(89)=  0.038772417506050821933_rk
      gaus%gi(90)=  0.116084070675255208483_rk
      gaus%gi(91)=  0.192697580701371099716_rk
      gaus%gi(92)=  0.268152185007253681141_rk
      gaus%gi(93)=  0.341994090825758473007_rk
      gaus%gi(94)=  0.413779204371605001525_rk
      gaus%gi(95)=  0.483075801686178712909_rk
      gaus%gi(96)=  0.549467125095128202076_rk
      gaus%gi(97)=  0.612553889667980237953_rk
      gaus%gi(98)=  0.671956684614179548379_rk
      gaus%gi(99)=  0.727318255189927103281_rk
      gaus%gi(100)= 0.778305651426519387695_rk
      gaus%gi(101)= 0.824612230833311663196_rk
      gaus%gi(102)= 0.865959503212259503821_rk
      gaus%gi(103)= 0.902098806968874296728_rk
      gaus%gi(104)= 0.932812808278676533361_rk
      gaus%gi(105)= 0.957916819213791655805_rk
      gaus%gi(106)= 0.977259949983774262663_rk
      gaus%gi(107)= 0.990726238699457006453_rk
      gaus%gi(108)= 0.998237709710559200350_rk

      gaus%ome(69)= 0.004521277098533191258_rk
      gaus%ome(70)= 0.010498284531152813615_rk
      gaus%ome(71)= 0.016421058381907888713_rk
      gaus%ome(72)= 0.022245849194166957262_rk
      gaus%ome(73)= 0.027937006980023401098_rk
      gaus%ome(74)= 0.033460195282547847393_rk
      gaus%ome(75)= 0.038782167974472017640_rk
      gaus%ome(76)= 0.043870908185673271992_rk
      gaus%ome(77)= 0.048695807635072232061_rk
      gaus%ome(78)= 0.053227846983936824355_rk
      gaus%ome(79)= 0.057439769099391551367_rk
      gaus%ome(80)= 0.061306242492928939167_rk
      gaus%ome(81)= 0.064804013456601038075_rk
      gaus%ome(82)= 0.067912045815233903826_rk
      gaus%ome(83)= 0.070611647391286779695_rk
      gaus%ome(84)= 0.072886582395804059061_rk
      gaus%ome(85)= 0.074723169057968264200_rk
      gaus%ome(86)= 0.076110361900626242372_rk
      gaus%ome(87)= 0.077039818164247965588_rk
      gaus%ome(88)= 0.077505947978424811264_rk

      gaus%ome(89)= 0.077505947978424811264_rk
      gaus%ome(90)= 0.077039818164247965588_rk
      gaus%ome(91)= 0.076110361900626242372_rk
      gaus%ome(92)= 0.074723169057968264200_rk
      gaus%ome(93)= 0.072886582395804059061_rk
      gaus%ome(94)= 0.070611647391286779695_rk
      gaus%ome(95)= 0.067912045815233903826_rk
      gaus%ome(96)= 0.064804013456601038075_rk
      gaus%ome(97)= 0.061306242492928939167_rk
      gaus%ome(98)= 0.057439769099391551367_rk
      gaus%ome(99)= 0.053227846983936824355_rk
      gaus%ome(100)=0.048695807635072232061_rk
      gaus%ome(101)=0.043870908185673271992_rk
      gaus%ome(102)=0.038782167974472017640_rk
      gaus%ome(103)=0.033460195282547847393_rk
      gaus%ome(104)=0.027937006980023401098_rk
      gaus%ome(105)=0.022245849194166957262_rk
      gaus%ome(106)=0.016421058381907888713_rk
      gaus%ome(107)=0.010498284531152813615_rk
      gaus%ome(108)=0.004521277098533191258_rk

!---  N =  48 ( ng1 = 109 , ng2 = 156 )
      gaus%ng1(8)=109
      gaus%ng2(8)=156
      gaus%gi(109)=-0.998771007252426118601_rk
      gaus%gi(110)=-0.993530172266350757548_rk
      gaus%gi(111)=-0.984124583722826857745_rk
      gaus%gi(112)=-0.970591592546247250461_rk
      gaus%gi(113)=-0.952987703160430860723_rk
      gaus%gi(114)=-0.931386690706554333114_rk
      gaus%gi(115)=-0.905879136715569672822_rk
      gaus%gi(116)=-0.876572020274247885906_rk
      gaus%gi(117)=-0.843588261624393530711_rk
      gaus%gi(118)=-0.807066204029442627083_rk
      gaus%gi(119)=-0.767159032515740339254_rk
      gaus%gi(120)=-0.724034130923814654674_rk
      gaus%gi(121)=-0.677872379632663905212_rk
      gaus%gi(122)=-0.628867396776513623995_rk
      gaus%gi(123)=-0.577224726083972703818_rk
      gaus%gi(124)=-0.523160974722233033678_rk
      gaus%gi(125)=-0.466902904750958404545_rk
      gaus%gi(126)=-0.408686481990716729916_rk
      gaus%gi(127)=-0.348755886292160738160_rk
      gaus%gi(128)=-0.287362487355455576736_rk
      gaus%gi(129)=-0.224763790394689061225_rk
      gaus%gi(130)=-0.161222356068891718056_rk
      gaus%gi(131)=-0.097004699209462698930_rk
      gaus%gi(132)=-0.032380170962869362033_rk

      gaus%gi(133)= 0.032380170962869362033_rk
      gaus%gi(134)= 0.097004699209462698930_rk
      gaus%gi(135)= 0.161222356068891718056_rk
      gaus%gi(136)= 0.224763790394689061225_rk
      gaus%gi(137)= 0.287362487355455576736_rk
      gaus%gi(138)= 0.348755886292160738160_rk
      gaus%gi(139)= 0.408686481990716729916_rk
      gaus%gi(140)= 0.466902904750958404545_rk
      gaus%gi(141)= 0.523160974722233033678_rk
      gaus%gi(142)= 0.577224726083972703818_rk
      gaus%gi(143)= 0.628867396776513623995_rk
      gaus%gi(144)= 0.677872379632663905212_rk
      gaus%gi(145)= 0.724034130923814654674_rk
      gaus%gi(146)= 0.767159032515740339254_rk
      gaus%gi(147)= 0.807066204029442627083_rk
      gaus%gi(148)= 0.843588261624393530711_rk
      gaus%gi(149)= 0.876572020274247885906_rk
      gaus%gi(150)= 0.905879136715569672822_rk
      gaus%gi(151)= 0.931386690706554333114_rk
      gaus%gi(152)= 0.952987703160430860723_rk
      gaus%gi(153)= 0.970591592546247250461_rk
      gaus%gi(154)= 0.984124583722826857745_rk
      gaus%gi(155)= 0.993530172266350757548_rk
      gaus%gi(156)= 0.998771007252426118601_rk

      gaus%ome(109)= 0.003153346052305838633_rk
      gaus%ome(110)= 0.007327553901276262102_rk
      gaus%ome(111)= 0.011477234579234539490_rk
      gaus%ome(112)= 0.015579315722943848728_rk
      gaus%ome(113)= 0.019616160457355527814_rk
      gaus%ome(114)= 0.023570760839324379141_rk
      gaus%ome(115)= 0.027426509708356948200_rk
      gaus%ome(116)= 0.031167227832798088902_rk
      gaus%ome(117)= 0.034777222564770438893_rk
      gaus%ome(118)= 0.038241351065830706317_rk
      gaus%ome(119)= 0.041545082943464749214_rk
      gaus%ome(120)= 0.044674560856694280419_rk
      gaus%ome(121)= 0.047616658492490474826_rk
      gaus%ome(122)= 0.050359035553854474958_rk
      gaus%ome(123)= 0.052890189485193667096_rk
      gaus%ome(124)= 0.055199503699984162868_rk
      gaus%ome(125)= 0.057277292100403215705_rk
      gaus%ome(126)= 0.059114839698395635746_rk
      gaus%ome(127)= 0.060704439165893880053_rk
      gaus%ome(128)= 0.062039423159892663904_rk
      gaus%ome(129)= 0.063114192286254025657_rk
      gaus%ome(130)= 0.063924238584648186624_rk
      gaus%ome(131)= 0.064466164435950082207_rk
      gaus%ome(132)= 0.064737696812683922503_rk

      gaus%ome(133)= 0.064737696812683922503_rk
      gaus%ome(134)= 0.064466164435950082207_rk
      gaus%ome(135)= 0.063924238584648186624_rk
      gaus%ome(136)= 0.063114192286254025657_rk
      gaus%ome(137)= 0.062039423159892663904_rk
      gaus%ome(138)= 0.060704439165893880053_rk
      gaus%ome(139)= 0.059114839698395635746_rk
      gaus%ome(140)= 0.057277292100403215705_rk
      gaus%ome(141)= 0.055199503699984162868_rk
      gaus%ome(142)= 0.052890189485193667096_rk
      gaus%ome(143)= 0.050359035553854474958_rk
      gaus%ome(144)= 0.047616658492490474826_rk
      gaus%ome(145)= 0.044674560856694280419_rk
      gaus%ome(146)= 0.041545082943464749214_rk
      gaus%ome(147)= 0.038241351065830706317_rk
      gaus%ome(148)= 0.034777222564770438893_rk
      gaus%ome(149)= 0.031167227832798088902_rk
      gaus%ome(150)= 0.027426509708356948200_rk
      gaus%ome(151)= 0.023570760839324379141_rk
      gaus%ome(152)= 0.019616160457355527814_rk
      gaus%ome(153)= 0.015579315722943848728_rk
      gaus%ome(154)= 0.011477234579234539490_rk
      gaus%ome(155)= 0.007327553901276262102_rk
      gaus%ome(156)= 0.003153346052305838633_rk
!
      END SUBROUTINE

      END MODULE
